<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>oEmbed-test</title>

    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }

        td, th {
            padding: 10px;
        }

        /*xmp{*/
        /*    vertical-align: middle;*/
        /*    text-align: center;*/
        /*    width: 85%;*/
        /*    float: right;*/
        /*    height: 50px;*/
        /*    white-space: normal ;*/
        /*}*/
    </style>
</head>
<body>

<input id="search" class="search" type="text"/>
<input class="btn" type="button" value="추가" onclick="search();"/>

<div id="container">

<!--    <blockquote class="twitter-tweet"><p lang="ko" dir="ltr">[🎧] <a href="https://twitter.com/hashtag/JISOO?src=hash&amp;ref_src=twsrc%5Etfw">#JISOO</a> 의 첫싱글 앨범 [ME]가 지금 공개되었습니다!<br>함께 들으러 가볼까요?👇<br><br>멜론: <a href="https://t.co/K4VVE1kE5c">https://t.co/K4VVE1kE5c</a><br>지니: <a href="https://t.co/0hkI6uPSJp">https://t.co/0hkI6uPSJp</a><br>바이브: <a href="https://t.co/tFJCobQKfv">https://t.co/tFJCobQKfv</a><br>플로: <a href="https://t.co/2n7pv8Fo6h">https://t.co/2n7pv8Fo6h</a><br>벅스: <a href="https://t.co/e6e8h75Tcs">https://t.co/e6e8h75Tcs</a><a href="https://twitter.com/hashtag/%EC%A7%80%EC%88%98?src=hash&amp;ref_src=twsrc%5Etfw">#지수</a> <a href="https://twitter.com/hashtag/BLACKPINK?src=hash&amp;ref_src=twsrc%5Etfw">#BLACKPINK</a> <a href="https://twitter.com/hashtag/%EB%B8%94%EB%9E%99%ED%95%91%ED%81%AC?src=hash&amp;ref_src=twsrc%5Etfw">#블랙핑크</a> <a href="https://twitter.com/hashtag/FIRSTSINGLEALBUM?src=hash&amp;ref_src=twsrc%5Etfw">#FIRSTSINGLEALBUM</a> <a href="https://twitter.com/hashtag/ME?src=hash&amp;ref_src=twsrc%5Etfw">#ME</a></p>&mdash; BLACKPINK GLOBAL BLINK (@ygofficialblink) <a href="https://twitter.com/ygofficialblink/status/1641652736449212416?ref_src=twsrc%5Etfw">March 31, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>-->

</div>

<script type="text/javascript">
    function search() {
        const url = document.getElementById("search").value;
        // url = "https://www.youtube.com/oembed?url=http%3A//youtube.com/watch%3Fv%3DM3r2XDceM6A&format=json";
        console.log("입력받은 url : " + url);
        $.ajax({
            type: 'GET',
            url: "/search",
            data: {"url": url},
            dataType: 'text',
            success: function (data) {
                convert(JSON.parse(data));
            },
            error: function (error) {
                console.log(error);
            }
        })
    }

    // JSON data to HTML table
    function convert(data) {

        let jsonData = data;

        console.log(jsonData);

        // Get the container element where the table will be inserted
        let container = document.getElementById("container");

        // Create the table element
        let table = document.createElement("table");

        // Get the keys (column names) of the first object in the JSON data
        let rows = Object.entries(jsonData);

        // Loop through the column names and create header cells
        rows.forEach((item) => {
            let tr = document.createElement("tr");
            let td = document.createElement("td");
            td.innerText = item[0]; // Set the column name as the text of the header cell
            let td2 = document.createElement("td");
            tr.appendChild(td); // Append the header cell to the header row

            if (item[0] == "html") {
                console.log("들어왔다!!!!!");

                // let xmp = document.createElement("xmp");
                // xmp.insertAdjacentHTML('beforeend',item[1]);

                td2.insertAdjacentHTML('beforeend', item[1]);
            } else if (item[0] == "thumbnail_url") {
                let img = document.createElement("img");
                img.src = item[1];

                td2.appendChild(img);
            } else {
                td2.innerText = item[1];
            }

            tr.appendChild(td2);

            table.append(tr);
        });
        container.appendChild(table) // Append the table to the container element

        // twttr.widgets.load(valueDiv);
        twttr.widgets.load(container);
    }

</script>
<script src="https://code.jquery.com/jquery-3.6.4.js"></script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</body>
</html>